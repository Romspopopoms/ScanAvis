(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[378],{1848:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/paymentstatus",function(){return __webpack_require__(7124)}])},8655:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893);__webpack_require__(7294);let Spinner=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"spinner-container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"spinner"})});__webpack_exports__.Z=Spinner},7124:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7294),next_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1163),next_link__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1664),next_link__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(next_link__WEBPACK_IMPORTED_MODULE_3__),_components_Spinner__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8655);let PaymentStatusPage=()=>{let router=(0,next_router__WEBPACK_IMPORTED_MODULE_2__.useRouter)(),{paymentStatus,paymentIntentId}=router.query,[transaction,setTransaction]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),[loading,setLoading]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0),[error,setError]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)("");return((0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{let fetchTransactionDetails=async()=>{if("succeeded"!==paymentStatus||!paymentIntentId){setLoading(!1);return}try{let response=await fetch("/.netlify/functions/get-transaction?paymentIntentId=".concat(paymentIntentId));if(!response.ok)throw Error("Erreur HTTP ! Statut : ".concat(response.status));let data=await response.json();if(!data.transaction)throw Error("Aucune donn\xe9e de transaction re\xe7ue");setTransaction(data.transaction)}catch(err){console.error("Erreur lors de la r\xe9cup\xe9ration de la transaction:",err),setError("\xc9chec de la r\xe9cup\xe9ration des donn\xe9es de transaction")}finally{setLoading(!1)}};fetchTransactionDetails()},[paymentStatus,paymentIntentId]),loading)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_Spinner__WEBPACK_IMPORTED_MODULE_4__.Z,{}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"min-h-screen flex justify-center items-center p-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"max-w-lg w-full bg-white shadow-xl rounded-lg p-8",children:error?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Oups !"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"mb-4",children:["Erreur : ",error]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_link__WEBPACK_IMPORTED_MODULE_3___default(),{href:"/",className:"inline-block bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition duration-200",children:"Retour \xe0 l'accueil"})]}):paymentStatus&&"failed"!==paymentStatus?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h1",{className:"text-2xl font-bold text-green-600 mb-4",children:"Merci pour votre achat !"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"Votre transaction a \xe9t\xe9 r\xe9alis\xe9e avec succ\xe8s."}),transaction&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-left",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"font-semibold",children:["ID de transaction : ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-normal",children:transaction.transactionId})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"font-semibold",children:["Montant : ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"font-normal",children:["$",(transaction.totalAmount/100).toFixed(2)]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"font-semibold",children:["Date de cr\xe9ation : ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-normal",children:new Date(transaction.createdAt).toLocaleString()})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"font-semibold mb-2",children:"Articles :"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("ul",{className:"list-disc pl-5",children:transaction.items.map((item,index)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-semibold",children:item.name})," - Quantit\xe9 : ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-normal",children:item.quantity})," - Prix : ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"font-normal",children:["$",(item.price/100).toFixed(2)]})]},index))})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_link__WEBPACK_IMPORTED_MODULE_3___default(),{href:"/",className:"inline-block bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600 transition duration-200 mt-4",children:"Retour \xe0 l'accueil"})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-xl font-bold text-yellow-500 mb-4",children:"Statut de Paiement Inconnu"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"Acc\xe8s non autoris\xe9 \xe0 cette page ou param\xe8tre manquant."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_link__WEBPACK_IMPORTED_MODULE_3___default(),{href:"/",className:"inline-block bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600 transition duration-200",children:"Retour \xe0 l'accueil"})]})})})};__webpack_exports__.default=PaymentStatusPage}},function(__webpack_require__){__webpack_require__.O(0,[774,888,179],function(){return __webpack_require__(__webpack_require__.s=1848)}),_N_E=__webpack_require__.O()}]);